NAME
    imgex_analysis - Analysis of Illumina gene expression microarray data.

SYNOPSIS
    imgex_analysis.pl [arguments]

    Required arguments:

       --experiment=[experiment name]
       --targets=[targets file]
       --input=[sample probe profile file]
       --yaml=[experiment yaml file]

    Optional arguments:

       --annotation=[annotation file]  If the annotation file is provided.
       --nosweave                      If the Sweave file should not be evaluated (run manually)

    To obtain help use either of these:

       --help     This help, or
       --manual   Verbose help

ARGUMENTS
    --experiment
            Required. Name of the experiment in the format
            experiment_name_yyyy-mm-dd.

    --targets
            Required. Targets file, contains the list of arrays to be
            processed and information needed for the differential expression
            analysis (contrasts).

    --input Required. Input file (sample probe profile) containing the
            expression data.

    --yaml  Required. File in YAML format containing specifications of the
            experiment and the analysis.

    --annotation
            Optional. The annotation file is needed only if it hasn't been
            included in the input file.

    --sweave/--nosweave
            Optional. Default is --sweave. Use --nosweave to tell the
            program not to evaluate the Sweave file (R code + analysis
            documentation), in which case it will need to be done manually
            via an R session or R CMD BATCH after the program finishes.

DESCRIPTION
    imgex_analysis.pl will allow you to run a full analysis of Illumina gene
    expression microarray data. The specification of the analysis is
    described inside a YAML file (the experiment YAML file). Various inputs
    are required to execute the analysis.

    Once the inputs have been checked for completeness and correctness (not
    completely infallible) various outputs are created, principally a pure R
    script and a Sweave document. The latter is sourced by default in order
    to execute the DE analysis.

    All inputs and outputs are saved in a bespoke directory named as
    especified by the argument --experiment.

  Sweave execution
    Unless you had used the --nosweave option, a Sweave(sweavedocument.Rnw)
    command will be executed for you automatically by imgex_analysis.pl
    using the LSF platform. This means a bsub job has been created and you
    will need to wait for its completion for you to be able to see the final
    PDF report of the analysis.

    In previous versions of the program, after all the files and directories
    had been created you were required to open an R session and manually
    execute the '.R' script generated for you. Additionally you were
    required to publish the results online in a Wiki style and then
    copy/move the files to their final destination.

    Since the decommissioning of the Wiki server a new way to deliver the
    results of the analysis had to be found. That new way is a PDF report
    generated by Sweave. Sweave combines the R script execution with the
    delivery of results in one file, the '.Rnw' file.

    After imgex_analysis has finished running you need to wait until LSF
    have finished executing the Sweave file. Use the following command to
    explore the status of the job:

    $> bjobs

    Which will output something similar to this:

    JOBID USER STAT QUEUE FROM_HOST EXEC_HOST JOB_NAME SUBMIT_TIME 9770642
    rb11 PEND normal bc-20-1-14 *01-16.Rnw Jan 27 17:16

    In this case the status of the job (column STAT) indicates it's PENDing.
    Succesive calls to bjobs will show different status, most importantly:
    RUN. Even later on, once the job has completed if you call again the
    bsub command you will see the message:

    $> No unfinished job found

    Which means the job has finished and the PDF document should be ready.
    Look for it inside the project directory and point the customer to it as
    the starting point for their review of the results.

    The final step for you will be to copy/move the project and all of its
    data to its final destination and similarly point the customer to it.
    Future versions of the program will do this automatically.

  Manually execute Sweave
    To manually execute the Sweave document you have two options:

    1) Open an interactive R session (by typing R in the command line inside
    the project directory) and run the following command, indicating the
    name of the .Rnw file:

    R> Sweave(sweavedocument.Rnw)

    2) Run R in batch mode (prefered). To do this you need to use LSF and
    although it's a long command you only need to copy/paste
    in-a-single-line> (i.e. no new lines in between) and replace the name of
    the .Rnw file. Do this inside the project directory:

    $> bsub -o bsuboutput.o -e bsuberror.e -R'select[mem>2900]
    rusage[mem=2900]' -M2900 ./sweave_wrapper.sh

    This will create an LSF job that you can inspect using the method
    described above. Once that is finished you will have a PDF file with all
    the information regarding the analysis. After that follow the
    instructions in the previous section as to how to deliver the results.

  Outliers
    Outlier arrays can only be discovered after the analysis has been done.
    Once they have been identified add them to the experiment's YAML file
    and run this program again.

    The list of outliers can be entered as a dashed list of items:

    - 1234567890_A - 2345678901_B

    Or as a single dashed item with the list of arrays separated by comas
    and enclosed in square brackets:

    - [1234567890_A, 2345678901_B]

    Don't forget to leave the necessary spaces (no tabs) before the '-'.

AUTHOR
    Ruben Bautista (rb11@sanger.ac.uk)

COPYRIGHT
    Copyright (C) 2014 Genome Research Ltd (GRL) by Ruben E. Bautista-Garcia

